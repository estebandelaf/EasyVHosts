Easy Virtual Hosts o EasyVHosts es una herramienta para la
administración de dominios virtuales de diferentes usuarios en un
sistema GNU/Linux. Utiliza un formato de directorios y archivos para
los dominios de los usuarios, obteniendo dinámicamente las
características de los mismos y generando automáticamente los
archivos de configuración para lo servicios involucrados (como httpd
o named).

1. Autodetección

EasyVHosts funciona con el principio de autodetección, verifica una
serie de directorios y archivos y dependiendo de su prescencia tomará
una u otra acción.

1.1. Dominios

Los dominios son definidos bajo el directorio WWW_DIR, cada uno de
los directorios aquí creados será una zona dentro del DNS. Así se
tendrá por ejemplo (asumiendo usuario delaf y WWW_DIR=www):

                     /home/delaf/www
                      |           |
                delaf.cl         sasco.cl

1.2. Subdominios

Los subdominios de cada dominio están dentro del directorio htdocs,
en este se colocan los dominios sin el dominio principal. En el caso
de subdominios en varios niveles se escriben al revés, ejemplo el
subdominio demo.clientes.sasco.cl se alojará dentro del directorio
htdocs del dominio sasco.cl como clientes.demo, el dominio principal
se compartirá con el dominio www, por lo cual sasco.cl será alojado
en el directorio www, de esta forma se tendrá:

                     /home/delaf/www
                      |           |
                delaf.cl         sasco.cl
                   |                |
                 htdocs           htdocs
                 |    |           |    |
               blog  www         www  clientes.sasco.cl 

1.3. Certificados SSL

Estos irán en el directorio ssl y tendrán como nombre el subdominio
más el dominio terminando en la extensión correspondiente, un ejemplo:

                     /home/delaf/www
                            |
                         delaf.cl
                            |
                           ssl
                           | |
           blog.delaf.cl.crt blog.delaf.cl.key
       (certificado firmado) (clave privada)

2. Configuración mediante archivos

Actualmente solo se puede personalizar la configuración para Apache.

2.2. Apache

El directorio de configuración por dominio es conf/httpd y se deberá
colocar un archivo por cada subdominio, con el nombre del subdominio,
el dominio y extensión .conf Dentro del archivo se podrán definir
ciertas opciones que modificarán la creación de la configuración para
Apache para dicho dominio. Un ejemplo:

                     /home/delaf/www
                            |
                         delaf.cl
                            |
                           conf
			    |
                          httpd
                            |
                    www.delaf.cl.conf

Dentro del archivo www.delaf.cl.conf:
ALIASES=*
REDIRECT_WWW=yes
SSL_FORCE=yes
SUPHP=yes

ALIASES		Indica a que otros nombres responde el dominio, si
		es * responderá a cualquier nombre que no haya sido
		definido por otro subdominio. Otra alternativa es
		especificar un listado separado por espacio de los
		subdominios (no se coloca el dominio).
		Ejemplos:
			ALIASES=*
			ALIASES=www2
			ALIASES=www2 www3
		Default:

REDIRECT_WWW	Indica si al utilizar www este será redireccionado
		al dominio pricipal, esto en caso que se quiera "evitar"
		que se acceda mediante www.example.com.
		Default: no

SSL_FORCE=yes	Fuerza el uso de HTTPS si el usuario entra mediante HTTP,
		requiere que exista un certificado en el directorio ssl
		que este asociado al dominio.
		Default: no

SUPHP=yes	Indica si se debe utilizar SuPHP para servir las páginas
		PHP del dominio.
		Defaultl: no

3. Ejecución

Para generar los archivos de configuración y recargar los servicios
basta ejecutar el script easyvhosts dentro del directorio bin, o sea
estándo dentro del directorio easyvhosts (si se usa como esta por
defecto) se puede hacer:

sudo bin/easyvhosts	<- En caso de usuario normal con sudo
bin/easyvhosts		<- En caso de usuario root


Para más información visitar la página del proyecto:

  http://dev.sasco.cl/easyvhosts

by Esteban De La Fuente Rubio

